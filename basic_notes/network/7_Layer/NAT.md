![NAT](https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/NAT_Concept-en.svg/1920px-NAT_Concept-en.svg.png)
![NAT](https://s8185.pcdn.co/wp-content/uploads/2013/11/41.jpg)
# NAT(Network Address Translation)
IP 패킷의 TCP/UDP 포트 숫자와 소스 및 목적지의 IP 주소 등을 재기록하며 라우터를 통해 네트워크 트래픽을 주고받는 기술이다.

쉽게 말하자면은 NAT이란 호스트의 아이피를 공인아이피`(public ip)`로 게스트들이 취급하여 그 아이피를 기준으로 가상의`(private IP)` ip를 사용하는 기술이다.    


* 특정 ip주소의 특정 포트로 가는 패킷을 다른ip주소의 다른 포트번호로 바꾸는 기술
* TCP/UDP의 체크섬도 다시 계산되어 재기록 해야됨
* 3~4계층까지 다시 프로토콜을 자기가 다시 만들고 그것을 기록하는것

# 쓰는 이유
* 사설 네트워크에 속한 여러 개의 호스트가 하나의 공인 IP 주소를 사용하여 인터넷에 접속하기 위해서입니다.

# 주의사항
* 사설을 공인으로 변화하는데만 사용하는건 아닙니다.  
* 구조의 설계는 쉬워지지만 네트워크의 모니터링이 어려워져서 보안을 할때 전문 tap장비를 아웃라인 방식으로 사용할수밖에 없게되므로 네트워크가 아이러니하게 더욱 복잡해지고 비용이 증가합니다.
* SPAN방식으로 모니터링이 가능하지만 당연하게도 데이터의 가용성이 침해될수 있기에 법적 증거로 인정되지 않습니다1.

# 추가설명

Network Address Translation 의 약자로써 네트워크 주소 변환을 의미합니다.  
기본적으로 192.168.xx와 같은 사설(Private) IP 주소로는 외부와 통신(인터넷 연결 등) 할 수 없습니다. 외부와 통신할 수있는 IP주소는 오직 인터넷 IP 주소 관리 기관에서 공식적으로 발급한 공인(Public) IP 주소 뿐 입니다.  
하지만 이러한 제약을 뛰어 넘고자 개발된 기술이 바로 NAT 는 사설 IP 주소와 공인 IP 주소를 변환해 주는 일종의 변환기 입니다.  
192.168.0.2와 같은 사설 IP 주소를 통해 외부로 네트워크 패킷을 보내게 되면 NAT 는 이를 119.200.124.81 와 같은 공인 IP 주소로(현재 연결된 공인 IP 주소) 변환하여 패킷을 내 보냄으로써 외부에선 마치 공인 IP에서 패킷을 보낸 것처럼 보이게 해주는 것이죠.   
반대로 외부에서 내부로 네트워크 패킷이 들어게 되면 NAT 에선 이를 어떤 사설 IP 에게 들어온 패킷인지 판단하여 해당 사설 IP로 패킷을 보내주게 됩니다.  
즉, 사설 IP 주소로는 원칙적으로 외부와 통신할 수 없기 때문에 이를 공인 IP 주소로 중간에 변환해 주어 외부와 통신(인터넷 연결) 할 수 잇게 해주는 것입니다.   
한가지 NAT는 장비가 아니라 기능 즉, 프로그램을 의미합니다. 그래서 라우터 등에 NAT 기능이 포함되어 있습니다. 흔히 NAT 기능이 포함된 라우터를 NAT 라우터라고 부릅니다.  
우리가 주변에서 흔히 볼 수 있는 NAT 라우터로는 바로 인터넷 공유기가 있습니다. 공유기는 허브/스위치의 역할도 하면서 동시에 NAT 기능을 탑재하여 우리가 하나의 인터넷 회선으로(공인IP) 다수의 컴퓨터에서(내부 사설 IP) 동시에 인터넷을 사용할 수 있게 해주는 것 입니다.   


VMware Workstation 은 이 NAT 라우터를 자체적으로 내장하여 내부 사설망으로 구성된 가상 머신들이 외부와 통신할 수 있게 해줍니다.

# DNAT(Destination Network Address Translation)

DNAT은 단순하게 말해서 웹사이트라는곳에 사용자가 접속을 시도하였을때 사용자가 입력한 아이피를  
방화벽을 통하여 NAT으로 만들어진 아이피에 연결하여 웹서버에 정상접속이 가능하게 하는것이다.   
즉 사내 보안정책을 통과하여 접속하게 만들어서 웹서버의 안정성을 높힌다. 물론 웹서버 뿐만이 아니라 다른것들도 가능하다.  


# SNAT(Source Network Address Translation)
![SNAT](./img/SNAT.png)
SNAT은 가정집을 생각하면된다. ISP(Internet Service Provider)인터넷 공급 업체를 통하여 받은 1개의 공인 아이피를 가정에서 여러개 사용할수있다.  
하지만 다른 서비스에 접근할때는 한개의 Public IP만 표시되게 된다. 즉 모뎀을 통하여 들어온 IP를 보통 가정집이면 라우터를 통하여 NAT으로 Private ip로  
가족들이 같은 공인아이피를 사용할수 있게된다. 이러한 기술을 SNAT이라 부른다.

# 보안적 측면

SNAT은 보안적 측면에서 조금 까